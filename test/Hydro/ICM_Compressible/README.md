# Test scripts for the compressible ICM


There are several tests in this folder:


## 1. Fluid dynamic structure factors

This test will compute the dynamic structure factors, $S_{uv}(k, w) = \left\langle u(k,w)v(k,w)^*\right\rangle$ of the fluid.  
The script will compute many identical runs and average the following correlations:  

  * $S_{\rho\rho}$  
  * $S_{v_xv_x}$  
  * $S_{v_xv_y}$  
  * $S_{\rho v_x}$  

The numerical results will be compared with theory taken from [1] and [2] (the actual theory data files were generated by solving the analytic results with a maple sheet).  
In particular, this script will reproduce figure 5 in [3].  

### Some details

The dynamic structure factors are computed in the following way. We perform a simulation without particles and let it relax. Then, for each step until the end of the simulation:  

* Fourier transform $\rho$, $v_x$ and $v_y$ in the whole domain.  
* Store only some wave numbers (the 2,2,2 at the time of writing). i.e $\rho(k=(2,2,2),t)$, etc.  
* Once enough times are stored Fourier transform in time to get $\rho(k, w)$,etc.  
* Compute $S_{uv}$ for each simulation and average.  

Finally the whole process is repeated a number of times to improve statistics and estimate error.  

Plots compared with theory are then produced.  

## 2. Tracer long time diffusion

This test will place a series of tracer particles inside a fluid and let them evolve with a certain temperature. It will then compute the mean square displacement and compute the diffusion coefficient from that.   
A normalized plot is produced to check for correctness.  
This plot should show a curve that tends to 1 at long times.  


## 3. Radial distribution function of a LJ liquid

This test computes the RDF of a LJ liquid using the compressible solver and compares with an equivalent simulation using a BD (no hydrodynamics) solver.  
Produces a plot comparing the two.  


## 4. Moving wall test  

This test places walls at the domain limits in the Z direction. The top wall is fixed while an oscillatory velocity in X is imposed on the bottom wall.

A fluid only simulation is performed and a plot comparing $v_x(z)$ with the theoretical result at several times is generated.

## Usage

Run test.bash in this folder.


### References:  

[1]  Hydrodynamic fluctuations in fluids and fluid mixtures. de Zarate 2006.  
[2]  Dynamic Light scattering. Berne and Pecora 1990.  
[3]  Staggered schemes for fluctuating hydrodynamics. Balboa et.al 2012. https://doi.org/10.1137/120864520  
